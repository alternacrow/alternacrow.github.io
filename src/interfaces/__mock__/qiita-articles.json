[
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>ISO 8601は、日付と時刻の表記に関するISOの国際規格です。（wikipedia調べ）<br>\nJavaScriptのDateのコンストラクタ（およびDate.parse）に使用できる日時の形式は、ISO 8601を基に仕様が定義されています。</p>\n\n<h1>\n<span id=\"使える形式\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E3%81%88%E3%82%8B%E5%BD%A2%E5%BC%8F\"><i class=\"fa fa-link\"></i></a>使える形式</h1>\n\n<p>下記の日付（+時刻+タイムゾーン識別子）の組み合わせで表現できます。</p>\n\n<ul>\n<li>日付\n\n<ul>\n<li><code>YYYY-MM-DD</code></li>\n<li><code>YYYY-MM</code></li>\n<li><code>YYYY</code></li>\n</ul>\n</li>\n<li>時刻\n\n<ul>\n<li><code>THH:mm</code></li>\n<li><code>THH:mm:ss</code></li>\n<li><code>THH:mm:ss.sss</code></li>\n</ul>\n</li>\n<li>タイムゾーン識別子\n\n<ul>\n<li>\n<code>Z</code>（<code>+00:00</code>に同じ）</li>\n<li>\n<code>-23:59</code>~<code>+23:59</code>\n</li>\n</ul>\n</li>\n</ul>\n\n<p>仕様で定められている形式以外にもパース可能なものはありますが、<br>\n実行環境によって結果が左右されるため、実際の動作については確認が必要になります。</p>\n\n<h1>\n<span id=\"使用例\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E7%94%A8%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>使用例</h1>\n\n<div class=\"code-frame\" data-lang=\"javascript\"><div class=\"highlight\"><pre><code><span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-28</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-28T00:00:00.000Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-01T00:00:00.000Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-01-01T00:00:00.000Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34:56.789Z</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T12:34:56.789Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11T12:34:56.789Z</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-01T12:34:56.789Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021T12:34:56.789Z</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-01-01T12:34:56.789Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34:56Z</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T12:34:56.000Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34Z</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T12:34:00.000Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34:56.789+00:00</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T12:34:56.789Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34:56.789-09:00</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T21:34:56.789Z</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">2021-11-12T12:34:56.789+09:00</span><span class=\"dl\">'</span><span class=\"p\">));</span>\n<span class=\"c1\">// -&gt; 2021-11-12T03:34:56.789Z</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h1>\n\n<p><qiita-embed-ogp src=\"https://ja.wikipedia.org/wiki/ISO_8601\"></qiita-embed-ogp></p>\n\n<p><qiita-embed-ogp src=\"https://tc39.es/ecma262/#sec-date-time-string-format\"></qiita-embed-ogp></p>\n\n<p><qiita-embed-ogp src=\"https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Date/parse\"></qiita-embed-ogp></p>\n",
    "body": "# はじめに\n\nISO 8601は、日付と時刻の表記に関するISOの国際規格です。（wikipedia調べ）\nJavaScriptのDateのコンストラクタ（およびDate.parse）に使用できる日時の形式は、ISO 8601を基に仕様が定義されています。\n\n# 使える形式\n\n下記の日付（+時刻+タイムゾーン識別子）の組み合わせで表現できます。\n\n- 日付\n - `YYYY-MM-DD`\n - `YYYY-MM`\n - `YYYY`\n- 時刻\n - `THH:mm`\n - `THH:mm:ss`\n - `THH:mm:ss.sss`\n- タイムゾーン識別子\n - `Z`（`+00:00`に同じ）\n - `-23:59`~`+23:59`\n\n仕様で定められている形式以外にもパース可能なものはありますが、\n実行環境によって結果が左右されるため、実際の動作については確認が必要になります。\n\n# 使用例\n\n```javascript\nconsole.log(new Date('2021-11-28'));\n// -> 2021-11-28T00:00:00.000Z\nconsole.log(new Date('2021-11'));\n// -> 2021-11-01T00:00:00.000Z\nconsole.log(new Date('2021'));\n// -> 2021-01-01T00:00:00.000Z\nconsole.log(new Date('2021-11-12T12:34:56.789Z'));\n// -> 2021-11-12T12:34:56.789Z\nconsole.log(new Date('2021-11T12:34:56.789Z'));\n// -> 2021-11-01T12:34:56.789Z\nconsole.log(new Date('2021T12:34:56.789Z'));\n// -> 2021-01-01T12:34:56.789Z\nconsole.log(new Date('2021-11-12T12:34:56Z'));\n// -> 2021-11-12T12:34:56.000Z\nconsole.log(new Date('2021-11-12T12:34Z'));\n// -> 2021-11-12T12:34:00.000Z\nconsole.log(new Date('2021-11-12T12:34:56.789+00:00'));\n// -> 2021-11-12T12:34:56.789Z\nconsole.log(new Date('2021-11-12T12:34:56.789-09:00'));\n// -> 2021-11-12T21:34:56.789Z\nconsole.log(new Date('2021-11-12T12:34:56.789+09:00'));\n// -> 2021-11-12T03:34:56.789Z\n```\n\n# 参考\n\nhttps://ja.wikipedia.org/wiki/ISO_8601\n\nhttps://tc39.es/ecma262/#sec-date-time-string-format\n\nhttps://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Date/parse\n\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-12-20T17:43:18+09:00",
    "group": null,
    "id": "4c89492ac8b078da9f14",
    "likes_count": 1,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "JavaScript",
        "versions": []
      },
      {
        "name": "ISO8601",
        "versions": []
      }
    ],
    "title": "JavaScriptで使えるISO 8601の形式",
    "updated_at": "2021-12-20T17:43:43+09:00",
    "url": "https://qiita.com/alternacrow/items/4c89492ac8b078da9f14",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>先日、CureAppで毎週行っている勉強会でTypeScriptのOmitの話になりました。<br>\nPickはインテリセンス効くけど、Omitはインテリセンス効かないというものです。<br>\nTypeScriptとしては<a href=\"https://github.com/microsoft/TypeScript/issues/30825\" rel=\"nofollow noopener\" target=\"_blank\">こちら</a>の議論の末、今のインテリセンスが効かない今の実装になっているようです。<br>\nインテリセンスが効くようにOmitをなんとか上書きできないかとちょくちょく調べていたのですが、<br>\nあまり良い方法が見つからず絶望したので、メモとして代替案を残しておこうと思います。</p>\n\n<h1>\n<span id=\"omitの実装\" class=\"fragment\"></span><a href=\"#omit%E3%81%AE%E5%AE%9F%E8%A3%85\"><i class=\"fa fa-link\"></i></a>Omitの実装</h1>\n\n<p>まず、Omitの実装を確認してみます。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"c1\">// lib.es5.d.ts</span>\n<span class=\"cm\">/**\n * Construct a type with the properties of T except for those in type K.\n */</span>\n<span class=\"kd\">type</span> <span class=\"nx\">Omit</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span> <span class=\"kd\">extends</span> <span class=\"kr\">keyof</span> <span class=\"kr\">any</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nb\">Pick</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">Exclude</span><span class=\"o\">&lt;</span><span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>個人的に<code>keyof any</code>を見て発狂しそうなのですが、Omitはtypeで宣言されているので上書きは出来ません。<br>\nなので、必然的に下記のどちらかの対応になりそうです。</p>\n\n<ul>\n<li>patch-packages等で、<code>lib.es5.d.ts</code>のOmitの実装を変更する</li>\n<li>マイOmitを作る</li>\n</ul>\n\n<h2>\n<span id=\"patch-packages等でlibes5dtsのomitの実装を変更する\" class=\"fragment\"></span><a href=\"#patch-packages%E7%AD%89%E3%81%A7libes5dts%E3%81%AEomit%E3%81%AE%E5%AE%9F%E8%A3%85%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>patch-packages等で、<code>lib.es5.d.ts</code>のOmitの実装を変更する</h2>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kd\">type</span> <span class=\"nx\">Omit</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span> <span class=\"kd\">extends</span> <span class=\"kr\">keyof</span> <span class=\"kr\">any</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nb\">Pick</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">Exclude</span><span class=\"o\">&lt;</span><span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>を</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kd\">type</span> <span class=\"nx\">Omit</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span> <span class=\"kd\">extends</span> <span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nb\">Pick</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">Exclude</span><span class=\"o\">&lt;</span><span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>に変更します。<br>\n使用しているTypeScriptのバージョン変更時にはパッチの修正が必要になりますが、<br>\n後者よりは対応が小さく済みます。</p>\n\n<h2>\n<span id=\"マイomitを作る\" class=\"fragment\"></span><a href=\"#%E3%83%9E%E3%82%A4omit%E3%82%92%E4%BD%9C%E3%82%8B\"><i class=\"fa fa-link\"></i></a>マイOmitを作る</h2>\n\n<p>議論でもあがっていましたが、下記のような独自Omitを作る方法です。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kd\">type</span> <span class=\"nx\">OmitScrict</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span> <span class=\"kd\">extends</span> <span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nb\">Pick</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">Exclude</span><span class=\"o\">&lt;</span><span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>Omitがあるのに、OmitStrict…（白目）</p>\n\n<p>ちなみに、組み込みのOmitを使用しないことを強制する場合は、eslintにルールを追加します。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"p\">{</span>\n  <span class=\"nl\">rules</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"dl\">'</span><span class=\"s1\">@typescript-eslint/ban-types</span><span class=\"dl\">'</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n      <span class=\"dl\">'</span><span class=\"s1\">error</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n      <span class=\"p\">{</span>\n        <span class=\"na\">types</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"na\">Omit</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">Use `OmitStrict`.</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n        <span class=\"p\">},</span>\n      <span class=\"p\">},</span>\n    <span class=\"p\">],</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"さいごに\" class=\"fragment\"></span><a href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"><i class=\"fa fa-link\"></i></a>さいごに</h1>\n\n<p>下記のような実装で済むのが理想でしたが、あまり良い方法が見つけられませんでした。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kr\">declare</span> <span class=\"kd\">type</span> <span class=\"nx\">Omit</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span> <span class=\"kd\">extends</span> <span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nb\">Pick</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">Exclude</span><span class=\"o\">&lt;</span><span class=\"kr\">keyof</span> <span class=\"nx\">T</span><span class=\"p\">,</span> <span class=\"nx\">K</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>他にもっと良い方法があったら教えて頂けると幸いです。</p>\n",
    "body": "# はじめに\n\n先日、CureAppで毎週行っている勉強会でTypeScriptのOmitの話になりました。\nPickはインテリセンス効くけど、Omitはインテリセンス効かないというものです。\nTypeScriptとしては[こちら](https://github.com/microsoft/TypeScript/issues/30825)の議論の末、今のインテリセンスが効かない今の実装になっているようです。\nインテリセンスが効くようにOmitをなんとか上書きできないかとちょくちょく調べていたのですが、\nあまり良い方法が見つからず絶望したので、メモとして代替案を残しておこうと思います。\n\n# Omitの実装\n\nまず、Omitの実装を確認してみます。\n\n```typescript\n// lib.es5.d.ts\n/**\n * Construct a type with the properties of T except for those in type K.\n */\ntype Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;\n```\n\n個人的に`keyof any`を見て発狂しそうなのですが、Omitはtypeで宣言されているので上書きは出来ません。\nなので、必然的に下記のどちらかの対応になりそうです。\n\n- patch-packages等で、`lib.es5.d.ts`のOmitの実装を変更する\n- マイOmitを作る\n\n## patch-packages等で、`lib.es5.d.ts`のOmitの実装を変更する\n\n```typescript\ntype Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;\n```\n\nを\n\n```typescript\ntype Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n```\n\nに変更します。\n使用しているTypeScriptのバージョン変更時にはパッチの修正が必要になりますが、\n後者よりは対応が小さく済みます。\n\n## マイOmitを作る\n\n議論でもあがっていましたが、下記のような独自Omitを作る方法です。\n\n```typescript\ntype OmitScrict<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n```\n\nOmitがあるのに、OmitStrict…（白目）\n\nちなみに、組み込みのOmitを使用しないことを強制する場合は、eslintにルールを追加します。\n\n```js\n{\n  rules: {\n    '@typescript-eslint/ban-types': [\n      'error',\n      {\n        types: {\n          Omit: \"Use `OmitStrict`.\",\n        },\n      },\n    ],\n  }\n}\n```\n\n# さいごに\n\n下記のような実装で済むのが理想でしたが、あまり良い方法が見つけられませんでした。\n\n```typescript\ndeclare type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n```\n\n他にもっと良い方法があったら教えて頂けると幸いです。\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-12-13T16:04:06+09:00",
    "group": null,
    "id": "01876533e29ed422803a",
    "likes_count": 6,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "TypeScript",
        "versions": []
      }
    ],
    "title": "TypeScriptのOmitが気持ち悪くてつらい",
    "updated_at": "2021-12-13T16:04:06+09:00",
    "url": "https://qiita.com/alternacrow/items/01876533e29ed422803a",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"tldr\" class=\"fragment\"></span><a href=\"#tldr\"><i class=\"fa fa-link\"></i></a>TL;DR</h1>\n\n<p>ScrollView内でSafeAreaView使うときは、ScrollViewに<code>contentInsetAdjustmentBehavior=\"automatic\"</code>のpropsを渡せばスクロールがぶっ壊れない。</p>\n\n<div class=\"code-frame\" data-lang=\"jsx\"><div class=\"highlight\"><pre><code><span class=\"p\">&lt;</span><span class=\"nc\">ScrollView</span> <span class=\"na\">contentInsetAdjustmentBehavior</span><span class=\"p\">=</span><span class=\"s\">\"automatic\"</span><span class=\"p\">&gt;</span> \n  <span class=\"p\">&lt;</span><span class=\"nc\">SafeAreaView</span><span class=\"p\">&gt;</span>\n    <span class=\"si\">{</span><span class=\"cm\">/* Long Content */</span><span class=\"si\">}</span>\n  <span class=\"p\">&lt;/</span><span class=\"nc\">SafeAreaView</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;/</span><span class=\"nc\">ScrollView</span><span class=\"p\">&gt;</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>React Nativeには、AndroidとiOSを同時に開発できる利点があります。<br>\n一方で、AndroidにはAndroidの、iOSにはiOSにしか無い仕様も存在し、その一つにiOSのセーフエリアがあります。</p>\n\n<p>セーフエリアには、上部のセーフエリア（Status Bar）と下部のセーフエリア（Home Indicator）の２つが存在します。<br>\nReact Nativeでは、SafeAreaViewというコンポーネントを利用することで、よしなにセーフエリア領域を扱うことができます。</p>\n\n<h1>\n<span id=\"scrollview内で使用するときの注意\" class=\"fragment\"></span><a href=\"#scrollview%E5%86%85%E3%81%A7%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AE%E6%B3%A8%E6%84%8F\"><i class=\"fa fa-link\"></i></a>ScrollView内で使用するときの注意</h1>\n\n<div class=\"code-frame\" data-lang=\"jsx\"><div class=\"highlight\"><pre><code><span class=\"p\">&lt;</span><span class=\"nc\">ScrollView</span> <span class=\"na\">contentInsetAdjustmentBehavior</span><span class=\"p\">=</span><span class=\"s\">\"automatic\"</span><span class=\"p\">&gt;</span> \n  <span class=\"p\">&lt;</span><span class=\"nc\">SafeAreaView</span><span class=\"p\">&gt;</span>\n    <span class=\"si\">{</span><span class=\"cm\">/* Long Content */</span><span class=\"si\">}</span>\n  <span class=\"p\">&lt;/</span><span class=\"nc\">SafeAreaView</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;/</span><span class=\"nc\">ScrollView</span><span class=\"p\">&gt;</span>\n</code></pre></div></div>\n",
    "body": "# TL;DR\nScrollView内でSafeAreaView使うときは、ScrollViewに`contentInsetAdjustmentBehavior=\"automatic\"`のpropsを渡せばスクロールがぶっ壊れない。\n\n```jsx\n<ScrollView contentInsetAdjustmentBehavior=\"automatic\"> \n  <SafeAreaView>\n    {/* Long Content */}\n  </SafeAreaView>\n</ScrollView>\n```\n\n# はじめに\nReact Nativeには、AndroidとiOSを同時に開発できる利点があります。\n一方で、AndroidにはAndroidの、iOSにはiOSにしか無い仕様も存在し、その一つにiOSのセーフエリアがあります。\n\nセーフエリアには、上部のセーフエリア（Status Bar）と下部のセーフエリア（Home Indicator）の２つが存在します。\nReact Nativeでは、SafeAreaViewというコンポーネントを利用することで、よしなにセーフエリア領域を扱うことができます。\n\n# ScrollView内で使用するときの注意\n\n\n\n```jsx\n<ScrollView contentInsetAdjustmentBehavior=\"automatic\"> \n  <SafeAreaView>\n    {/* Long Content */}\n  </SafeAreaView>\n</ScrollView>\n```\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-12-06T21:00:53+09:00",
    "group": null,
    "id": "80468a28aef96994f5a1",
    "likes_count": 0,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "react-native",
        "versions": []
      }
    ],
    "title": "SafeAreaViewをScrollView内で使用するときの注意点",
    "updated_at": "2021-12-06T21:00:53+09:00",
    "url": "https://qiita.com/alternacrow/items/80468a28aef96994f5a1",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>React Nativeでは、htmlのようにsvgファイルを素の状態で利用することができません。<br>\nreact-native-svgというライブラリを使用する必要があり、React Nativeで扱えるように変換する必要があります。<br>\n変換にはいくつか方法がありますが、下記のような種類があります。</p>\n\n<ul>\n<li><a href=\"#react-native-svg-transformer%E3%81%A7svg%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%81%9D%E3%81%AE%E3%81%BE%E3%81%BE%E4%BD%BF%E3%81%86\">react-native-svg-transformerでsvgファイルをそのまま使う</a></li>\n<li><a href=\"#cli---svgrcli%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\">CLI - @svgr/cliでコンポーネントファイルに変換</a></li>\n<li><a href=\"#gui---svg-playground%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\">GUI - SVG Playgroundでコンポーネントファイルに変換</a></li>\n<li><a href=\"#%E6%9C%80%E5%88%9D%E3%81%8B%E3%82%89react-native-svg%E3%81%A7%E6%9B%B8%E3%81%8F\">最初からreact-native-svgで書く</a></li>\n</ul>\n\n<h1>\n<span id=\"各方法のメリットデメリット\" class=\"fragment\"></span><a href=\"#%E5%90%84%E6%96%B9%E6%B3%95%E3%81%AE%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88%E3%83%87%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88\"><i class=\"fa fa-link\"></i></a>各方法のメリット・デメリット</h1>\n\n<h2>\n<span id=\"react-native-svg-transformerでsvgファイルをそのまま使う\" class=\"fragment\"></span><a href=\"#react-native-svg-transformer%E3%81%A7svg%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%81%9D%E3%81%AE%E3%81%BE%E3%81%BE%E4%BD%BF%E3%81%86\"><i class=\"fa fa-link\"></i></a>react-native-svg-transformerでsvgファイルをそのまま使う</h2>\n\n<p><qiita-embed-ogp src=\"https://github.com/kristerkari/react-native-svg-transformer\"></qiita-embed-ogp></p>\n\n<p>svgファイルを直接importする方法です。<br>\n大量のsvgファイルを扱う場合に、設定を書くだけで利用できます。</p>\n\n<ul>\n<li>メリット\n\n<ul>\n<li>変換の手順を踏まず、svgファイルを直接読み込める。</li>\n<li>設定を書けば、propsによるfillやstrokeの色指定等可能</li>\n</ul>\n</li>\n<li>デメリット\n\n<ul>\n<li>svgファイルの構成が統一されていない場合、設定での調整が難しい</li>\n<li>TypeScriptを使用する場合、declarationが必要\n\n<ul>\n<li>公式参照 <a href=\"https://github.com/kristerkari/react-native-svg-transformer#using-typescript\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://github.com/kristerkari/react-native-svg-transformer#using-typescript</a>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n\n<h2>\n<span id=\"cli---svgrcliでコンポーネントファイルに変換\" class=\"fragment\"></span><a href=\"#cli---svgrcli%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\"><i class=\"fa fa-link\"></i></a>CLI - @svgr/cliでコンポーネントファイルに変換</h2>\n\n<p><qiita-embed-ogp src=\"https://github.com/gregberge/svgr\"></qiita-embed-ogp></p>\n\n<p>svgファイルをCLIでreact-native-svgに変換したファイルをimportする方法です。<br>\n変換後のファイルがどうなっているか確認が容易です。</p>\n\n<ul>\n<li>メリット\n\n<ul>\n<li>変換後のファイルを確認、調整可能</li>\n<li>設定を書けば、propsによるfillやstrokeの色指定等可能</li>\n</ul>\n</li>\n<li>デメリット\n\n<ul>\n<li>オプションが一部しかconfigファイルに書けないため、細かい設定、調整をしたい場合にコマンドが長くなりがち</li>\n<li>svgファイルの構成が統一されていない場合、設定での調整が難しい</li>\n</ul>\n</li>\n</ul>\n\n<h2>\n<span id=\"gui---svg-playgroundでコンポーネントファイルに変換\" class=\"fragment\"></span><a href=\"#gui---svg-playground%E3%81%A7%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%A4%89%E6%8F%9B\"><i class=\"fa fa-link\"></i></a>GUI - SVG Playgroundでコンポーネントファイルに変換</h2>\n\n<p><qiita-embed-ogp src=\"https://react-svgr.com/playground/\"></qiita-embed-ogp></p>\n\n<p>GUIでsvgファイルを変換、調整可能な方法です。<br>\nローカルのsvgファイルをドラッグアンドドロップして読み込めます。</p>\n\n<ul>\n<li>メリット\n\n<ul>\n<li>各ファイルに対して個別の設定、調整が可能</li>\n<li>CLIや細かい設定での調整が苦手でも扱いやすい</li>\n</ul>\n</li>\n<li>デメリット\n\n<ul>\n<li>一つひとつのファイルに対して手動変換を行うので、svgファイルの数が増えれば増えるほどしんどい</li>\n</ul>\n</li>\n</ul>\n\n<h2>\n<span id=\"最初からreact-native-svgで書く\" class=\"fragment\"></span><a href=\"#%E6%9C%80%E5%88%9D%E3%81%8B%E3%82%89react-native-svg%E3%81%A7%E6%9B%B8%E3%81%8F\"><i class=\"fa fa-link\"></i></a>最初からreact-native-svgで書く</h2>\n\n<p>通常、svgエディタを使用してsvgを作成、その後React Native用に変換という手順をすっ飛ばし、コードで書いちゃうマンの方法です。<br>\n自作のグラフを作成する場合などに有効な方法です。</p>\n\n<p><qiita-embed-ogp src=\"https://github.com/react-native-svg/react-native-svg\"></qiita-embed-ogp></p>\n\n<ul>\n<li>メリット\n\n<ul>\n<li>svgファイルとはなんだったのか</li>\n</ul>\n</li>\n<li>デメリット\n\n<ul>\n<li>しんどい。しんどくない？</li>\n</ul>\n</li>\n</ul>\n\n<h1>\n<span id=\"さいごに\" class=\"fragment\"></span><a href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"><i class=\"fa fa-link\"></i></a>さいごに</h1>\n\n<p>react-native-svgではまだサポートされていないsvgの機能があります。<br>\n変換後の見え方に違和感がある場合は、cliやguiで変換するとサポートされていない機能についてコメントされるので確認してみてください。</p>\n\n<p>他にも良い方法やおかしな点がある場合には、コメント頂けるとありがたいです。</p>\n",
    "body": "# はじめに\nReact Nativeでは、htmlのようにsvgファイルを素の状態で利用することができません。\nreact-native-svgというライブラリを使用する必要があり、React Nativeで扱えるように変換する必要があります。\n変換にはいくつか方法がありますが、下記のような種類があります。\n\n- [react-native-svg-transformerでsvgファイルをそのまま使う](#react-native-svg-transformerでsvgファイルをそのまま使う)\n- [CLI - @svgr/cliでコンポーネントファイルに変換](#cli---svgrcliでコンポーネントファイルに変換)\n- [GUI - SVG Playgroundでコンポーネントファイルに変換](#gui---svg-playgroundでコンポーネントファイルに変換)\n- [最初からreact-native-svgで書く](#最初からreact-native-svgで書く)\n\n# 各方法のメリット・デメリット\n\n## react-native-svg-transformerでsvgファイルをそのまま使う\n\nhttps://github.com/kristerkari/react-native-svg-transformer\n\nsvgファイルを直接importする方法です。\n大量のsvgファイルを扱う場合に、設定を書くだけで利用できます。\n\n- メリット\n    - 変換の手順を踏まず、svgファイルを直接読み込める。\n    - 設定を書けば、propsによるfillやstrokeの色指定等可能\n- デメリット\n    - svgファイルの構成が統一されていない場合、設定での調整が難しい\n    - TypeScriptを使用する場合、declarationが必要\n        - 公式参照 https://github.com/kristerkari/react-native-svg-transformer#using-typescript\n\n## CLI - @svgr/cliでコンポーネントファイルに変換\n\nhttps://github.com/gregberge/svgr\n\nsvgファイルをCLIでreact-native-svgに変換したファイルをimportする方法です。\n変換後のファイルがどうなっているか確認が容易です。\n\n- メリット\n    - 変換後のファイルを確認、調整可能\n    - 設定を書けば、propsによるfillやstrokeの色指定等可能\n- デメリット\n    - オプションが一部しかconfigファイルに書けないため、細かい設定、調整をしたい場合にコマンドが長くなりがち\n    - svgファイルの構成が統一されていない場合、設定での調整が難しい\n\n## GUI - SVG Playgroundでコンポーネントファイルに変換\n\nhttps://react-svgr.com/playground/\n\nGUIでsvgファイルを変換、調整可能な方法です。\nローカルのsvgファイルをドラッグアンドドロップして読み込めます。\n\n- メリット\n    - 各ファイルに対して個別の設定、調整が可能\n    - CLIや細かい設定での調整が苦手でも扱いやすい\n- デメリット\n    - 一つひとつのファイルに対して手動変換を行うので、svgファイルの数が増えれば増えるほどしんどい\n\n## 最初からreact-native-svgで書く\n\n通常、svgエディタを使用してsvgを作成、その後React Native用に変換という手順をすっ飛ばし、コードで書いちゃうマンの方法です。\n自作のグラフを作成する場合などに有効な方法です。\n\nhttps://github.com/react-native-svg/react-native-svg\n\n- メリット\n  - svgファイルとはなんだったのか\n- デメリット\n  - しんどい。しんどくない？\n\n# さいごに\n\nreact-native-svgではまだサポートされていないsvgの機能があります。\n変換後の見え方に違和感がある場合は、cliやguiで変換するとサポートされていない機能についてコメントされるので確認してみてください。\n\n他にも良い方法やおかしな点がある場合には、コメント頂けるとありがたいです。\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-11-22T14:36:15+09:00",
    "group": null,
    "id": "762e44c1b5c0a3100908",
    "likes_count": 2,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "SVG",
        "versions": []
      },
      {
        "name": "react-native",
        "versions": []
      }
    ],
    "title": "React NativeでSVGを扱う",
    "updated_at": "2021-11-22T14:36:15+09:00",
    "url": "https://qiita.com/alternacrow/items/762e44c1b5c0a3100908",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>スマートフォンがダークモードに対応してから、今ではスマホアプリでもウェブサイトでもダークモードに対応しているのが珍しくなくなりました。<br>\n私の周りではダークモードを使っている人がほとんどで、私も常時ダークモードにしています。</p>\n\n<p>ただ、開発者の視点ではダークモード対応は機能として必須ではないため、個人アプリの開発や後回しにしがちだと思います。<br>\nそんなときは、端末のダークモード設定を無視し、アプリ上では常にライトモードにすることができます。</p>\n\n<h1>\n<span id=\"実装\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A3%85\"><i class=\"fa fa-link\"></i></a>実装</h1>\n\n<h2>\n<span id=\"ios\" class=\"fragment\"></span><a href=\"#ios\"><i class=\"fa fa-link\"></i></a>iOS</h2>\n\n<div class=\"code-frame\" data-lang=\"objective_c\"><div class=\"highlight\"><pre><code><span class=\"cm\">/* AppRoot/ios/AppName/AppDelegate.m */</span>\n\n<span class=\"k\">-</span> <span class=\"p\">(</span><span class=\"n\">BOOL</span><span class=\"p\">)</span><span class=\"nf\">application</span><span class=\"p\">:(</span><span class=\"n\">UIApplication</span> <span class=\"o\">*</span><span class=\"p\">)</span><span class=\"nv\">application</span> <span class=\"nf\">didFinishLaunchingWithOptions</span><span class=\"p\">:(</span><span class=\"n\">NSDictionary</span> <span class=\"o\">*</span><span class=\"p\">)</span><span class=\"nv\">launchOptions</span>\n<span class=\"p\">{</span>\n<span class=\"cp\">#ifdef FB_SONARKIT_ENABLED\n</span>  <span class=\"n\">InitializeFlipper</span><span class=\"p\">(</span><span class=\"n\">application</span><span class=\"p\">);</span>\n<span class=\"cp\">#endif\n</span>\n  <span class=\"p\">...</span>\n\n  <span class=\"cm\">/**\n   * この3行を追加\n   * iOS13以降でライトモードを強制する\n   */</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"err\">@available</span><span class=\"p\">(</span><span class=\"n\">iOS</span> <span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n    <span class=\"n\">self</span><span class=\"p\">.</span><span class=\"n\">window</span><span class=\"p\">.</span><span class=\"n\">overrideUserInterfaceStyle</span> <span class=\"o\">=</span> <span class=\"n\">UIUserInterfaceStyleLight</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"k\">return</span> <span class=\"nb\">YES</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"android\" class=\"fragment\"></span><a href=\"#android\"><i class=\"fa fa-link\"></i></a>Android</h2>\n\n<div class=\"code-frame\" data-lang=\"java\"><div class=\"highlight\"><pre><code><span class=\"cm\">/* AppRoot/android/app/src/main/java/com/AppName/MainApplication.java */</span>\n\n<span class=\"kn\">package</span> <span class=\"nn\">com.AppName</span>\n\n<span class=\"c1\">// この行を追加</span>\n<span class=\"kn\">import</span> <span class=\"nn\">androidx.appcompat.app.AppCompatDelegate</span><span class=\"o\">;</span>\n<span class=\"kn\">import</span> <span class=\"nn\">android.app.Application</span><span class=\"o\">;</span>\n  <span class=\"o\">...</span>\n\n  <span class=\"nd\">@Override</span>\n  <span class=\"kd\">public</span> <span class=\"kt\">void</span> <span class=\"nf\">onCreate</span><span class=\"o\">()</span> <span class=\"o\">{</span>\n    <span class=\"kd\">super</span><span class=\"o\">.</span><span class=\"na\">onCreate</span><span class=\"o\">();</span>\n    <span class=\"nc\">SoLoader</span><span class=\"o\">.</span><span class=\"na\">init</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">,</span> <span class=\"cm\">/* native exopackage */</span> <span class=\"kc\">false</span><span class=\"o\">);</span>\n    <span class=\"n\">initializeFlipper</span><span class=\"o\">(</span><span class=\"k\">this</span><span class=\"o\">,</span> <span class=\"n\">getReactNativeHost</span><span class=\"o\">().</span><span class=\"na\">getReactInstanceManager</span><span class=\"o\">());</span>\n     <span class=\"c1\">// この行を追加</span>\n    <span class=\"nc\">AppCompatDelegate</span><span class=\"o\">.</span><span class=\"na\">setDefaultNightMode</span><span class=\"o\">(</span><span class=\"nc\">AppCompatDelegate</span><span class=\"o\">.</span><span class=\"na\">MODE_NIGHT_NO</span><span class=\"o\">);</span>\n  <span class=\"o\">}</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"expoの場合\" class=\"fragment\"></span><a href=\"#expo%E3%81%AE%E5%A0%B4%E5%90%88\"><i class=\"fa fa-link\"></i></a>Expoの場合</h2>\n\n<p>app.json</p>\n\n<div class=\"code-frame\" data-lang=\"json\"><div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"expo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"userInterfaceStyle\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"light\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>expo.userInterfaceStyleは一括設定なので、<br>\n下記のように個別に設定することも可能</p>\n\n<div class=\"code-frame\" data-lang=\"json\"><div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"expo\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"userInterfaceStyle\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"automatic\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"nl\">\"ios\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n      </span><span class=\"nl\">\"userInterfaceStyle\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"light\"</span><span class=\"p\">,</span><span class=\"w\">\n    </span><span class=\"p\">}</span><span class=\"w\">\n  </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n",
    "body": "# はじめに\nスマートフォンがダークモードに対応してから、今ではスマホアプリでもウェブサイトでもダークモードに対応しているのが珍しくなくなりました。\n私の周りではダークモードを使っている人がほとんどで、私も常時ダークモードにしています。\n\nただ、開発者の視点ではダークモード対応は機能として必須ではないため、個人アプリの開発や後回しにしがちだと思います。\nそんなときは、端末のダークモード設定を無視し、アプリ上では常にライトモードにすることができます。\n\n# 実装\n\n## iOS\n\n```objective_c\n/* AppRoot/ios/AppName/AppDelegate.m */\n\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\n{\n#ifdef FB_SONARKIT_ENABLED\n  InitializeFlipper(application);\n#endif\n\n  ...\n\n  /**\n   * この3行を追加\n   * iOS13以降でライトモードを強制する\n   */\n  if (@available(iOS 13, *)) {\n    self.window.overrideUserInterfaceStyle = UIUserInterfaceStyleLight;\n  }\n\n  return YES;\n}\n```\n\n## Android\n\n```java\n/* AppRoot/android/app/src/main/java/com/AppName/MainApplication.java */\n\npackage com.AppName\n\n// この行を追加\nimport androidx.appcompat.app.AppCompatDelegate;\nimport android.app.Application;\n  ...\n\n  @Override\n  public void onCreate() {\n    super.onCreate();\n    SoLoader.init(this, /* native exopackage */ false);\n    initializeFlipper(this, getReactNativeHost().getReactInstanceManager());\n     // この行を追加\n    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);\n  }\n```\n\n## Expoの場合\n\napp.json\n\n```json\n{\n  \"expo\": {\n    \"userInterfaceStyle\": \"light\",\n  }\n}\n```\n\nexpo.userInterfaceStyleは一括設定なので、\n下記のように個別に設定することも可能\n\n```json\n{\n  \"expo\": {\n    \"userInterfaceStyle\": \"automatic\",\n    \"ios\": {\n      \"userInterfaceStyle\": \"light\",\n    }\n  }\n}\n```\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-11-14T19:19:48+09:00",
    "group": null,
    "id": "5ffc633fc51a99aae34e",
    "likes_count": 0,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "react-native",
        "versions": []
      },
      {
        "name": "expo",
        "versions": []
      },
      {
        "name": "DarkMode",
        "versions": []
      }
    ],
    "title": "React Nativeでライトモードを強制する",
    "updated_at": "2021-11-14T19:19:48+09:00",
    "url": "https://qiita.com/alternacrow/items/5ffc633fc51a99aae34e",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>TypeScriptでNext.jsを書くとき、<br>\nパスの生成やパスパラメータの取得に型が付くといいなと思っていたので、書きました。</p>\n\n<h1>\n<span id=\"リポジトリ\" class=\"fragment\"></span><a href=\"#%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA\"><i class=\"fa fa-link\"></i></a>リポジトリ</h1>\n\n<p><qiita-embed-ogp src=\"https://github.com/alternacrow/next-routing-with-typescript\"></qiita-embed-ogp></p>\n\n<h1>\n<span id=\"コード\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>コード</h1>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">useRouter</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">\"</span><span class=\"s2\">next/router</span><span class=\"dl\">\"</span><span class=\"p\">;</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">Paths</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"na\">home</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">users</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/users</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">user</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/users/[userId]</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">blogs</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/users/[userId]/blogs</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">blog</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/users/[userId]/blogs/[blogId]</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">address</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/address/[prefecture]/[...cities]</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">calc</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">/calc/[operator]/[[...numbers]]</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n<span class=\"p\">}</span> <span class=\"k\">as</span> <span class=\"kd\">const</span><span class=\"p\">;</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">PathNames</span> <span class=\"o\">=</span> <span class=\"kr\">keyof</span> <span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">Path</span> <span class=\"o\">=</span> <span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">PathNames</span><span class=\"p\">];</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">WithoutSlash</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`/</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">U</span><span class=\"p\">}</span><span class=\"s2\">`</span> <span class=\"p\">?</span> <span class=\"nx\">U</span> <span class=\"p\">:</span> <span class=\"nx\">never</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">Resource</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">U</span><span class=\"p\">}</span><span class=\"s2\">/</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">S</span><span class=\"p\">}</span><span class=\"s2\">`</span> <span class=\"p\">?</span> <span class=\"nx\">U</span> <span class=\"o\">|</span> <span class=\"nx\">Resource</span><span class=\"o\">&lt;</span><span class=\"nx\">S</span><span class=\"o\">&gt;</span> <span class=\"p\">:</span> <span class=\"nx\">T</span><span class=\"p\">;</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">DynamicOptionalArrayRoute</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`[[...</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">U</span><span class=\"p\">}</span><span class=\"s2\">]]`</span> <span class=\"p\">?</span> <span class=\"nx\">U</span> <span class=\"p\">:</span> <span class=\"nx\">never</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">DynamicArrayRoute</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`[...</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">U</span><span class=\"p\">}</span><span class=\"s2\">]`</span> <span class=\"p\">?</span> <span class=\"nx\">U</span> <span class=\"p\">:</span> <span class=\"nx\">never</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">DynamicRoute</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`[[...</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">_U</span><span class=\"p\">}</span><span class=\"s2\">]]`</span>\n  <span class=\"p\">?</span> <span class=\"nx\">never</span>\n  <span class=\"p\">:</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`[...</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">_U</span><span class=\"p\">}</span><span class=\"s2\">]`</span>\n  <span class=\"p\">?</span> <span class=\"nx\">never</span>\n  <span class=\"p\">:</span> <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"s2\">`[</span><span class=\"p\">${</span><span class=\"nx\">infer</span> <span class=\"nx\">U</span><span class=\"p\">}</span><span class=\"s2\">]`</span>\n  <span class=\"p\">?</span> <span class=\"nx\">U</span>\n  <span class=\"p\">:</span> <span class=\"nx\">never</span><span class=\"p\">;</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">OptionalArrayParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">DynamicOptionalArrayRoute</span><span class=\"o\">&lt;</span>\n  <span class=\"nx\">Resource</span><span class=\"o\">&lt;</span><span class=\"nx\">WithoutSlash</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span>\n<span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">ArrayParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">DynamicArrayRoute</span><span class=\"o\">&lt;</span><span class=\"nx\">Resource</span><span class=\"o\">&lt;</span><span class=\"nx\">WithoutSlash</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;&gt;</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">Params</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">DynamicRoute</span><span class=\"o\">&lt;</span><span class=\"nx\">Resource</span><span class=\"o\">&lt;</span><span class=\"nx\">WithoutSlash</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;&gt;</span><span class=\"p\">;</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">OptionalArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">Path</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">OptionalArrayParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">ArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">Path</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">ArrayParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"kd\">type</span> <span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">Path</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">Params</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">PathParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">PathNames</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"na\">pathname</span><span class=\"p\">:</span> <span class=\"nx\">T</span><span class=\"p\">;</span>\n  <span class=\"nl\">params</span><span class=\"p\">?:</span> <span class=\"nb\">Partial</span><span class=\"o\">&lt;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">OptionalArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kr\">number</span><span class=\"p\">)[]</span><span class=\"o\">&gt;</span>\n  <span class=\"o\">&gt;</span> <span class=\"o\">&amp;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">ArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kr\">number</span><span class=\"p\">)[]</span><span class=\"o\">&gt;</span> <span class=\"o\">&amp;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kr\">number</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n\n<span class=\"kd\">type</span> <span class=\"nx\">Args</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">PathNames</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span> <span class=\"kd\">extends</span> <span class=\"nx\">never</span>\n  <span class=\"p\">?</span> <span class=\"nx\">PathParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span>\n  <span class=\"p\">:</span> <span class=\"nx\">Required</span><span class=\"o\">&lt;</span><span class=\"nx\">PathParams</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">createPath</span> <span class=\"o\">=</span> <span class=\"o\">&lt;</span><span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">PathNames</span><span class=\"o\">&gt;</span><span class=\"p\">({</span>\n  <span class=\"nx\">pathname</span><span class=\"p\">,</span>\n  <span class=\"nx\">params</span><span class=\"p\">,</span>\n<span class=\"p\">}:</span> <span class=\"nx\">Args</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">path</span> <span class=\"o\">=</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">pathname</span><span class=\"p\">];</span>\n\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">params</span> <span class=\"o\">===</span> <span class=\"kc\">undefined</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"nx\">path</span><span class=\"p\">;</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">directories</span> <span class=\"o\">=</span> <span class=\"nx\">path</span><span class=\"p\">.</span><span class=\"nx\">split</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">replacedDirectories</span> <span class=\"o\">=</span> <span class=\"nx\">directories</span><span class=\"p\">.</span><span class=\"nx\">map</span><span class=\"p\">((</span><span class=\"nx\">str</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">matchOptionalArray</span> <span class=\"o\">=</span> <span class=\"nx\">str</span><span class=\"p\">.</span><span class=\"nx\">match</span><span class=\"p\">(</span><span class=\"sr\">/</span><span class=\"se\">\\[\\[\\.\\.\\.(</span><span class=\"sr\">.*</span><span class=\"se\">?)\\]\\]</span><span class=\"sr\">/</span><span class=\"p\">);</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">matchOptionalArray</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"kd\">const</span> <span class=\"nx\">key</span> <span class=\"o\">=</span> <span class=\"nx\">matchOptionalArray</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"k\">as</span> <span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">path</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n      <span class=\"kd\">const</span> <span class=\"nx\">param</span> <span class=\"o\">=</span> <span class=\"nx\">params</span><span class=\"p\">[</span><span class=\"nx\">key</span><span class=\"p\">];</span>\n      <span class=\"k\">return</span> <span class=\"nx\">param</span> <span class=\"p\">?</span> <span class=\"nx\">param</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span><span class=\"p\">)</span> <span class=\"p\">:</span> <span class=\"dl\">\"\"</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">const</span> <span class=\"nx\">matchArray</span> <span class=\"o\">=</span> <span class=\"nx\">str</span><span class=\"p\">.</span><span class=\"nx\">match</span><span class=\"p\">(</span><span class=\"sr\">/</span><span class=\"se\">\\[\\.\\.\\.(</span><span class=\"sr\">.*</span><span class=\"se\">?)\\]</span><span class=\"sr\">/</span><span class=\"p\">);</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">matchArray</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"kd\">const</span> <span class=\"nx\">key</span> <span class=\"o\">=</span> <span class=\"nx\">matchArray</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"k\">as</span> <span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">path</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n      <span class=\"k\">return</span> <span class=\"nx\">params</span><span class=\"p\">[</span><span class=\"nx\">key</span><span class=\"p\">].</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"kd\">const</span> <span class=\"nx\">match</span> <span class=\"o\">=</span> <span class=\"nx\">str</span><span class=\"p\">.</span><span class=\"nx\">match</span><span class=\"p\">(</span><span class=\"sr\">/</span><span class=\"se\">\\[(</span><span class=\"sr\">.*</span><span class=\"se\">?)\\]</span><span class=\"sr\">/</span><span class=\"p\">);</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">match</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"kd\">const</span> <span class=\"nx\">key</span> <span class=\"o\">=</span> <span class=\"nx\">match</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">];</span>\n      <span class=\"kd\">const</span> <span class=\"nx\">trimmed</span> <span class=\"o\">=</span> <span class=\"nx\">key</span><span class=\"p\">.</span><span class=\"nx\">substring</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nx\">key</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span>\n        <span class=\"k\">typeof</span> <span class=\"nx\">path</span>\n      <span class=\"o\">&gt;</span><span class=\"p\">;</span>\n      <span class=\"k\">return</span> <span class=\"nx\">params</span><span class=\"p\">[</span><span class=\"nx\">trimmed</span><span class=\"p\">];</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"k\">return</span> <span class=\"nx\">str</span><span class=\"p\">;</span>\n  <span class=\"p\">});</span>\n\n  <span class=\"k\">return</span> <span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span> <span class=\"o\">+</span> <span class=\"nx\">replacedDirectories</span><span class=\"p\">.</span><span class=\"nx\">filter</span><span class=\"p\">((</span><span class=\"nx\">d</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"nx\">d</span> <span class=\"o\">!==</span> <span class=\"dl\">\"\"</span><span class=\"p\">).</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">/</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n<span class=\"p\">};</span>\n\n<span class=\"k\">export</span> <span class=\"kd\">const</span> <span class=\"nx\">usePathParams</span> <span class=\"o\">=</span> <span class=\"o\">&lt;</span>\n  <span class=\"nx\">T</span> <span class=\"kd\">extends</span> <span class=\"nx\">PathNames</span> <span class=\"o\">=</span> <span class=\"nx\">PathNames</span><span class=\"p\">,</span>\n  <span class=\"nx\">Query</span> <span class=\"kd\">extends</span> <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"kr\">string</span><span class=\"p\">,</span> <span class=\"kr\">string</span> <span class=\"o\">|</span> <span class=\"kr\">string</span><span class=\"p\">[]</span><span class=\"o\">&gt;</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n<span class=\"o\">&gt;</span><span class=\"p\">()</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">router</span> <span class=\"o\">=</span> <span class=\"nx\">useRouter</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">params</span> <span class=\"o\">=</span> <span class=\"nx\">router</span><span class=\"p\">.</span><span class=\"nx\">query</span> <span class=\"k\">as</span> <span class=\"nb\">Partial</span><span class=\"o\">&lt;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">OptionalArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"kr\">string</span><span class=\"p\">[]</span><span class=\"o\">&gt;</span>\n  <span class=\"o\">&gt;</span> <span class=\"o\">&amp;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">ArrayParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"kr\">string</span><span class=\"p\">[]</span><span class=\"o\">&gt;</span> <span class=\"o\">&amp;</span>\n    <span class=\"nb\">Record</span><span class=\"o\">&lt;</span><span class=\"nx\">ParamKeys</span><span class=\"o\">&lt;</span><span class=\"k\">typeof</span> <span class=\"nx\">Paths</span><span class=\"p\">[</span><span class=\"nx\">T</span><span class=\"p\">]</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"kr\">string</span><span class=\"o\">&gt;</span> <span class=\"o\">&amp;</span>\n    <span class=\"nb\">Partial</span><span class=\"o\">&lt;</span><span class=\"nx\">Query</span><span class=\"o\">&gt;</span><span class=\"p\">;</span>\n\n  <span class=\"k\">return</span> <span class=\"nx\">params</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"使い方\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\"><i class=\"fa fa-link\"></i></a>使い方</h1>\n\n<p>まず、パスを定数として定義した<code>Paths</code>を用意します。<br>\nkeyにはページ名を、valueには動的ルーティングをstringで設定します。</p>\n\n<p>パスの生成には<code>createPath</code>を使用します。<br>\n<code>pathname</code>を指定すると、必要なパラメータをparamsに渡すよう要求されます。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"cm\">/**\n * 生成されるパス\n * /address/hokkaido/sendai/hakodate\n */</span>\n<span class=\"kd\">const</span> <span class=\"nx\">address</span> <span class=\"o\">=</span> <span class=\"nx\">createPath</span><span class=\"p\">({</span>\n  <span class=\"na\">pathname</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">address</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"na\">params</span><span class=\"p\">:</span> <span class=\"p\">{</span> <span class=\"na\">prefecture</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">hokkaido</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"na\">cities</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"dl\">\"</span><span class=\"s2\">sendai</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"dl\">\"</span><span class=\"s2\">hakodate</span><span class=\"dl\">\"</span><span class=\"p\">]</span> <span class=\"p\">},</span>\n<span class=\"p\">});</span>\n</code></pre></div></div>\n\n<p>各NextPageでパラメータを取得するときは、<code>usePathParams</code>を使用します。<br>\nusePathParamsに<code>Paths</code>で定義したページ名を型引数として渡すことで、<br>\n対応したパラメータを取得できます。<br>\n他にクエリなども使用している場合は、型の第２引数にオブジェクトで渡します。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"cm\">/**\n * prefecture: string;\n * cities: string[];\n * name?: string;\n */</span>\n<span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"nx\">prefecture</span><span class=\"p\">,</span> <span class=\"nx\">cities</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"nx\">usePathParams</span><span class=\"o\">&lt;</span><span class=\"dl\">\"</span><span class=\"s2\">address</span><span class=\"dl\">\"</span><span class=\"p\">,</span> <span class=\"p\">{</span> <span class=\"na\">name</span><span class=\"p\">:</span> <span class=\"kr\">string</span> <span class=\"p\">}</span><span class=\"o\">&gt;</span><span class=\"p\">();</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"さいごに\" class=\"fragment\"></span><a href=\"#%E3%81%95%E3%81%84%E3%81%94%E3%81%AB\"><i class=\"fa fa-link\"></i></a>さいごに</h1>\n\n<p>もっと良い書き方やバグ等あれば教えていただけると嬉しいです。</p>\n\n<h1>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h1>\n\n<p><qiita-embed-ogp src=\"https://zenn.dev/panda_program/articles/typescript-nextjs-routing\"></qiita-embed-ogp></p>\n",
    "body": "# はじめに\nTypeScriptでNext.jsを書くとき、\nパスの生成やパスパラメータの取得に型が付くといいなと思っていたので、書きました。\n\n# リポジトリ\nhttps://github.com/alternacrow/next-routing-with-typescript\n\n# コード\n```typescript\nimport { useRouter } from \"next/router\";\n\nconst Paths = {\n  home: \"/\",\n  users: \"/users\",\n  user: \"/users/[userId]\",\n  blogs: \"/users/[userId]/blogs\",\n  blog: \"/users/[userId]/blogs/[blogId]\",\n  address: \"/address/[prefecture]/[...cities]\",\n  calc: \"/calc/[operator]/[[...numbers]]\",\n} as const;\n\ntype PathNames = keyof typeof Paths;\ntype Path = typeof Paths[PathNames];\n\ntype WithoutSlash<T> = T extends `/${infer U}` ? U : never;\ntype Resource<T> = T extends `${infer U}/${infer S}` ? U | Resource<S> : T;\n\ntype DynamicOptionalArrayRoute<T> = T extends `[[...${infer U}]]` ? U : never;\ntype DynamicArrayRoute<T> = T extends `[...${infer U}]` ? U : never;\ntype DynamicRoute<T> = T extends `[[...${infer _U}]]`\n  ? never\n  : T extends `[...${infer _U}]`\n  ? never\n  : T extends `[${infer U}]`\n  ? U\n  : never;\n\ntype OptionalArrayParams<T> = DynamicOptionalArrayRoute<\n  Resource<WithoutSlash<T>>\n>;\ntype ArrayParams<T> = DynamicArrayRoute<Resource<WithoutSlash<T>>>;\ntype Params<T> = DynamicRoute<Resource<WithoutSlash<T>>>;\n\ntype OptionalArrayParamKeys<T extends Path> = OptionalArrayParams<T>;\ntype ArrayParamKeys<T extends Path> = ArrayParams<T>;\ntype ParamKeys<T extends Path> = Params<T>;\n\ntype PathParams<T extends PathNames> = {\n  pathname: T;\n  params?: Partial<\n    Record<OptionalArrayParamKeys<typeof Paths[T]>, (string | number)[]>\n  > &\n    Record<ArrayParamKeys<typeof Paths[T]>, (string | number)[]> &\n    Record<ParamKeys<typeof Paths[T]>, string | number>;\n};\n\ntype Args<T extends PathNames> = ParamKeys<typeof Paths[T]> extends never\n  ? PathParams<T>\n  : Required<PathParams<T>>;\n\nexport const createPath = <T extends PathNames>({\n  pathname,\n  params,\n}: Args<T>) => {\n  const path = Paths[pathname];\n\n  if (params === undefined) {\n    return path;\n  }\n\n  const directories = path.split(\"/\");\n\n  const replacedDirectories = directories.map((str) => {\n    const matchOptionalArray = str.match(/\\[\\[\\.\\.\\.(.*?)\\]\\]/);\n    if (matchOptionalArray) {\n      const key = matchOptionalArray[1] as ParamKeys<typeof path>;\n      const param = params[key];\n      return param ? param.join(\"/\") : \"\";\n    }\n\n    const matchArray = str.match(/\\[\\.\\.\\.(.*?)\\]/);\n    if (matchArray) {\n      const key = matchArray[1] as ParamKeys<typeof path>;\n      return params[key].join(\"/\");\n    }\n\n    const match = str.match(/\\[(.*?)\\]/);\n    if (match) {\n      const key = match[0];\n      const trimmed = key.substring(1, key.length - 1) as ParamKeys<\n        typeof path\n      >;\n      return params[trimmed];\n    }\n\n    return str;\n  });\n\n  return \"/\" + replacedDirectories.filter((d) => d !== \"\").join(\"/\");\n};\n\nexport const usePathParams = <\n  T extends PathNames = PathNames,\n  Query extends Record<string, string | string[]> = {}\n>() => {\n  const router = useRouter();\n  const params = router.query as Partial<\n    Record<OptionalArrayParamKeys<typeof Paths[T]>, string[]>\n  > &\n    Record<ArrayParamKeys<typeof Paths[T]>, string[]> &\n    Record<ParamKeys<typeof Paths[T]>, string> &\n    Partial<Query>;\n\n  return params;\n};\n```\n\n# 使い方\nまず、パスを定数として定義した`Paths`を用意します。\nkeyにはページ名を、valueには動的ルーティングをstringで設定します。\n\nパスの生成には`createPath`を使用します。\n`pathname`を指定すると、必要なパラメータをparamsに渡すよう要求されます。\n\n```typescript\n/**\n * 生成されるパス\n * /address/hokkaido/sendai/hakodate\n */\nconst address = createPath({\n  pathname: \"address\",\n  params: { prefecture: \"hokkaido\", cities: [\"sendai\", \"hakodate\"] },\n});\n```\n\n各NextPageでパラメータを取得するときは、`usePathParams`を使用します。\nusePathParamsに`Paths`で定義したページ名を型引数として渡すことで、\n対応したパラメータを取得できます。\n他にクエリなども使用している場合は、型の第２引数にオブジェクトで渡します。\n\n```typescript\n/**\n * prefecture: string;\n * cities: string[];\n * name?: string;\n */\nconst { prefecture, cities } = usePathParams<\"address\", { name: string }>();\n```\n\n# さいごに\nもっと良い書き方やバグ等あれば教えていただけると嬉しいです。\n\n# 参考\nhttps://zenn.dev/panda_program/articles/typescript-nextjs-routing\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-10-24T18:02:34+09:00",
    "group": null,
    "id": "9ca4dbd1cb93936baf47",
    "likes_count": 0,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "TypeScript",
        "versions": []
      },
      {
        "name": "next.js",
        "versions": []
      }
    ],
    "title": "Next.jsのDynamicRoutesに型をつける",
    "updated_at": "2021-10-28T21:57:17+09:00",
    "url": "https://qiita.com/alternacrow/items/9ca4dbd1cb93936baf47",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>最近 ReactNative で個人アプリ作っていて、<br>\nArray に shuffle や clone 等の拡張を追加したくなった。<br><br>\nプライベートでは JavaScript で prototype を拡張していたことはあるが、<br>\n業務では使ってこなかったし、TypeScript で書く場合、型周りをどう書くのか良く分からなかったので、<br>\nprototype 拡張 を TypeScript で実際に書いてみた。</p>\n\n<h1>\n<span id=\"リポジトリ\" class=\"fragment\"></span><a href=\"#%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA\"><i class=\"fa fa-link\"></i></a>リポジトリ</h1>\n\n<p><qiita-embed-ogp src=\"https://github.com/alternacrow/prototype-with-typescript\"></qiita-embed-ogp></p>\n\n<p>shuffle, clone, unique 等追加してます。</p>\n\n<h1>\n<span id=\"実装例\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A3%85%E4%BE%8B\"><i class=\"fa fa-link\"></i></a>実装例</h1>\n\n<p>Array を任意の長さで分割する <code>chunks</code> というメソッドを追加してみます。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kr\">interface</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">chunks</span><span class=\"p\">(</span><span class=\"na\">size</span><span class=\"p\">:</span> <span class=\"kr\">number</span><span class=\"p\">):</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">Array</span><span class=\"p\">.</span><span class=\"nx\">prototype</span><span class=\"p\">.</span><span class=\"nx\">chunks</span> <span class=\"o\">===</span> <span class=\"kc\">undefined</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"nb\">Array</span><span class=\"p\">.</span><span class=\"nx\">prototype</span><span class=\"p\">.</span><span class=\"nx\">chunks</span> <span class=\"o\">=</span> <span class=\"kd\">function</span> <span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">(</span>\n    <span class=\"k\">this</span><span class=\"p\">:</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n    <span class=\"nx\">size</span><span class=\"p\">:</span> <span class=\"kr\">number</span>\n  <span class=\"p\">):</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span> <span class=\"p\">{</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"k\">this</span> <span class=\"o\">==</span> <span class=\"kc\">null</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n      <span class=\"k\">throw</span> <span class=\"k\">new</span> <span class=\"nx\">TypeError</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">Array.prototype.chunks called on null or undefined</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"k\">return</span> <span class=\"p\">[...</span><span class=\"nb\">Array</span><span class=\"p\">(</span><span class=\"nb\">Math</span><span class=\"p\">.</span><span class=\"nx\">ceil</span><span class=\"p\">(</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">/</span> <span class=\"nx\">size</span><span class=\"p\">))].</span><span class=\"nx\">map</span><span class=\"p\">((</span><span class=\"nx\">_</span><span class=\"p\">,</span> <span class=\"nx\">index</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n      <span class=\"k\">return</span> <span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">slice</span><span class=\"p\">(</span><span class=\"nx\">index</span> <span class=\"o\">*</span> <span class=\"nx\">size</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"nx\">index</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"o\">*</span> <span class=\"nx\">size</span><span class=\"p\">);</span>\n    <span class=\"p\">});</span>\n  <span class=\"p\">};</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>まず、Array が chunks メソッドを持っていることを TypeScript に認識させるために、<br>\nArray の interface に chunks の型を定義します。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"kr\">interface</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">chunks</span><span class=\"p\">(</span><span class=\"na\">size</span><span class=\"p\">:</span> <span class=\"kr\">number</span><span class=\"p\">):</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>型定義はこれだけです。</p>\n\n<p>次は実際に chunks メソッドを実装している箇所を見てみます。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"p\">...</span>\n  <span class=\"nb\">Array</span><span class=\"p\">.</span><span class=\"nx\">prototype</span><span class=\"p\">.</span><span class=\"nx\">chunks</span> <span class=\"o\">=</span> <span class=\"kd\">function</span> <span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">(</span>\n    <span class=\"k\">this</span><span class=\"p\">:</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>\n    <span class=\"nx\">size</span><span class=\"p\">:</span> <span class=\"kr\">number</span>\n  <span class=\"p\">):</span> <span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nb\">Array</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;&gt;</span> <span class=\"p\">{</span>\n<span class=\"p\">...</span>\n</code></pre></div></div>\n\n<p>第一引数には Array 自体が、第二引数以降には chunks の引数が入ってきます。<br>\nあとは、破壊的、非破壊的の性質に注意しながら、書いていけば良いかと思います。</p>\n\n<h1>\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h1>\n\n<p>業務では prototype 拡張は使いたくないと思っているんですが、<br>\n良い運用方法とかあればコメントもらえると嬉しいです。</p>\n",
    "body": "# はじめに\n\n最近 ReactNative で個人アプリ作っていて、\nArray に shuffle や clone 等の拡張を追加したくなった。  \nプライベートでは JavaScript で prototype を拡張していたことはあるが、\n業務では使ってこなかったし、TypeScript で書く場合、型周りをどう書くのか良く分からなかったので、\nprototype 拡張 を TypeScript で実際に書いてみた。\n\n# リポジトリ\n\nhttps://github.com/alternacrow/prototype-with-typescript\n\nshuffle, clone, unique 等追加してます。\n\n# 実装例\n\nArray を任意の長さで分割する `chunks` というメソッドを追加してみます。\n\n```typescript\ninterface Array<T> {\n  chunks(size: number): Array<Array<T>>;\n}\n\nif (Array.prototype.chunks === undefined) {\n  Array.prototype.chunks = function <T>(\n    this: Array<T>,\n    size: number\n  ): Array<Array<T>> {\n    if (this == null) {\n      throw new TypeError(\"Array.prototype.chunks called on null or undefined\");\n    }\n\n    return [...Array(Math.ceil(this.length / size))].map((_, index) => {\n      return this.slice(index * size, (index + 1) * size);\n    });\n  };\n}\n```\n\nまず、Array が chunks メソッドを持っていることを TypeScript に認識させるために、\nArray の interface に chunks の型を定義します。\n\n```typescript\ninterface Array<T> {\n  chunks(size: number): Array<Array<T>>;\n}\n```\n\n型定義はこれだけです。\n\n次は実際に chunks メソッドを実装している箇所を見てみます。\n\n```typescript\n...\n  Array.prototype.chunks = function <T>(\n    this: Array<T>,\n    size: number\n  ): Array<Array<T>> {\n...\n```\n\n第一引数には Array 自体が、第二引数以降には chunks の引数が入ってきます。\nあとは、破壊的、非破壊的の性質に注意しながら、書いていけば良いかと思います。\n\n# おわりに\n\n業務では prototype 拡張は使いたくないと思っているんですが、\n良い運用方法とかあればコメントもらえると嬉しいです。\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-10-04T07:46:51+09:00",
    "group": null,
    "id": "5ff1b2d66b33db44b624",
    "likes_count": 1,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "TypeScript",
        "versions": []
      },
      {
        "name": "prototype",
        "versions": []
      }
    ],
    "title": "prototypeの拡張をTypeScriptで書いてみる",
    "updated_at": "2021-10-27T12:19:59+09:00",
    "url": "https://qiita.com/alternacrow/items/5ff1b2d66b33db44b624",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>今までhuskyの4系を使っていたのですが、気づいたら7系まであがっていました。<br>\nで、久しぶりに入れてみたら4系の設定で動かなかったので、<br>\nコミット時にhusky,lint-stagedで、eslint,prettierを走らせる設定手順を書き残しておきます。</p>\n\n<h1>\n<span id=\"リポジトリ\" class=\"fragment\"></span><a href=\"#%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA\"><i class=\"fa fa-link\"></i></a>リポジトリ</h1>\n\n<p>コード（設定）はこちら</p>\n\n<p><qiita-embed-ogp src=\"https://github.com/alternacrow/Husky7AndLintStaged\"></qiita-embed-ogp></p>\n\n<h1>\n<span id=\"ライブラリとバージョン\" class=\"fragment\"></span><a href=\"#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%A8%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3\"><i class=\"fa fa-link\"></i></a>ライブラリとバージョン</h1>\n\n<div class=\"code-frame\" data-lang=\"json\"><div class=\"highlight\"><pre><code><span class=\"nl\">\"husky\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"7.0.2\"</span><span class=\"w\">\n</span><span class=\"nl\">\"lint-staged\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"11.1.2\"</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<h1>\n<span id=\"手順\" class=\"fragment\"></span><a href=\"#%E6%89%8B%E9%A0%86\"><i class=\"fa fa-link\"></i></a>手順</h1>\n\n<h2>\n<span id=\"lint-stagedの設定\" class=\"fragment\"></span><a href=\"#lint-staged%E3%81%AE%E8%A8%AD%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>lint-stagedの設定</h2>\n\n<p>パッケージの追加</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>yarn add <span class=\"nt\">-D</span> lint-staged\n</code></pre></div></div>\n\n<p>gitのステージングのファイル処理の設定を追加</p>\n\n<p>ステージにあがっている対象ファイルに対して、lintとprettierをかける。<br>\n処理後、処理された状態で自動addされる</p>\n\n<p><code>.lintstagedrc.js</code></p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"nx\">module</span><span class=\"p\">.</span><span class=\"nx\">exports</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n  <span class=\"dl\">\"</span><span class=\"s2\">*.{js,jsx,ts,tsx}</span><span class=\"dl\">\"</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n    <span class=\"dl\">\"</span><span class=\"s2\">eslint --fix</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n    <span class=\"dl\">\"</span><span class=\"s2\">prettier --write</span><span class=\"dl\">\"</span><span class=\"p\">,</span>\n  <span class=\"p\">],</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"huskyの設定\" class=\"fragment\"></span><a href=\"#husky%E3%81%AE%E8%A8%AD%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>huskyの設定</h2>\n\n<p>パッケージの追加</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>yarn add <span class=\"nt\">-D</span> husky\n</code></pre></div></div>\n\n<p>huskyの設定をインストール</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>npx husky <span class=\"nb\">install</span>\n</code></pre></div></div>\n\n<p>prepareスクリプトを追加</p>\n\n<p><code>package.json</code></p>\n\n<div class=\"code-frame\" data-lang=\"json\"><div class=\"highlight\"><pre><code><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"nl\">\"scripts\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">\n    </span><span class=\"nl\">\"prepare\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"husky install\"</span><span class=\"w\">\n  </span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<p>pre-commit時に、lint-stagedの処理が走るように設定を追加</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>npx husky add .husky/pre-commit <span class=\"s2\">\"yarn lint-staged\"</span>\n</code></pre></div></div>\n\n<p>下記のファイルが追加されます</p>\n\n<p><code>.husky/pre-commit</code></p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code><span class=\"c\">#!/bin/sh</span>\n<span class=\"nb\">.</span> <span class=\"s2\">\"</span><span class=\"si\">$(</span><span class=\"nb\">dirname</span> <span class=\"s2\">\"</span><span class=\"nv\">$0</span><span class=\"s2\">\"</span><span class=\"si\">)</span><span class=\"s2\">/_/husky.sh\"</span>\n\nyarn lint-staged\n</code></pre></div></div>\n\n<h1>\n<span id=\"どう使うの\" class=\"fragment\"></span><a href=\"#%E3%81%A9%E3%81%86%E4%BD%BF%E3%81%86%E3%81%AE\"><i class=\"fa fa-link\"></i></a>どう使うの</h1>\n\n<p>修正ファイルをコミットすれば、対象ファイルに対して、<br>\n<code>eslint --fix</code>と<code>prettier --write</code>が走り、整形してくれます。<br>\nテストなども走らせたい場合には、<br>\n<code>.husky/pre-commit</code>にスクリプトを追加することで様々な処理を行うことが出来ます。</p>\n\n<h1>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h1>\n\n<p><qiita-embed-ogp src=\"https://typicode.github.io/husky/#/\"></qiita-embed-ogp></p>\n\n<p><qiita-embed-ogp src=\"https://github.com/okonet/lint-staged\"></qiita-embed-ogp></p>\n",
    "body": "# はじめに\n今までhuskyの4系を使っていたのですが、気づいたら7系まであがっていました。\nで、久しぶりに入れてみたら4系の設定で動かなかったので、\nコミット時にhusky,lint-stagedで、eslint,prettierを走らせる設定手順を書き残しておきます。\n\n# リポジトリ\n\nコード（設定）はこちら\n\nhttps://github.com/alternacrow/Husky7AndLintStaged\n\n# ライブラリとバージョン\n\n```json\n\"husky\": \"7.0.2\"\n\"lint-staged\": \"11.1.2\"\n```\n\n# 手順\n\n## lint-stagedの設定\n\nパッケージの追加\n\n```bash\nyarn add -D lint-staged\n```\n\ngitのステージングのファイル処理の設定を追加\n\nステージにあがっている対象ファイルに対して、lintとprettierをかける。\n処理後、処理された状態で自動addされる\n\n`.lintstagedrc.js`\n\n```js\nmodule.exports = {\n  \"*.{js,jsx,ts,tsx}\": [\n    \"eslint --fix\",\n    \"prettier --write\",\n  ],\n}\n```\n\n## huskyの設定\n\nパッケージの追加\n\n```bash\nyarn add -D husky\n```\n\nhuskyの設定をインストール\n\n```bash\nnpx husky install\n```\n\nprepareスクリプトを追加\n\n`package.json`\n\n```json\n{\n  \"scripts\": {\n    \"prepare\": \"husky install\"\n  }\n}\n```\n\npre-commit時に、lint-stagedの処理が走るように設定を追加\n\n```bash\nnpx husky add .husky/pre-commit \"yarn lint-staged\"\n```\n\n下記のファイルが追加されます\n\n`.husky/pre-commit`\n\n```bash\n#!/bin/sh\n. \"$(dirname \"$0\")/_/husky.sh\"\n\nyarn lint-staged\n```\n\n# どう使うの\n修正ファイルをコミットすれば、対象ファイルに対して、\n`eslint --fix`と`prettier --write`が走り、整形してくれます。\nテストなども走らせたい場合には、\n`.husky/pre-commit`にスクリプトを追加することで様々な処理を行うことが出来ます。\n\n# 参考\n\nhttps://typicode.github.io/husky/#/\n\nhttps://github.com/okonet/lint-staged\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-09-06T15:34:12+09:00",
    "group": null,
    "id": "1dd9092e923fe445e8e6",
    "likes_count": 2,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "lint-staged",
        "versions": []
      },
      {
        "name": "husky",
        "versions": []
      }
    ],
    "title": "気づいたらhuskyが7系になっていたので、導入手順確認する",
    "updated_at": "2021-09-06T15:34:12+09:00",
    "url": "https://qiita.com/alternacrow/items/1dd9092e923fe445e8e6",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>Expoは、React Nativeでのアプリ開発を超絶楽に行えるフレームワークです。<br>\nExpoのフルマネージド環境下では、優れた開発体験と引き換えに、ネイティブの機能はExpoで提供されているもの以外を使用できません。<br>\nExpoのAPI郡を使用しながらネイティブの機能を使用するライブラリを使用したい場合、<br>\nExpoプロジェクトの初期化時にBare Workflowを選択したり、<br>\nExpoフルマネージドプロジェクトをejectする等の方法があります。<br>\n今回は既存のReact Nativeプロジェクトでexpo-notificationsを使用する手順を紹介します。</p>\n\n<p><qiita-embed-ogp src=\"https://expo.dev/\"></qiita-embed-ogp></p>\n\n<h1>\n<span id=\"リポジトリ\" class=\"fragment\"></span><a href=\"#%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA\"><i class=\"fa fa-link\"></i></a>リポジトリ</h1>\n\n<p>コードはこちら</p>\n\n<p><qiita-embed-ogp src=\"https://github.com/alternacrow/ExistingReactNativeWithExpoNotifications\"></qiita-embed-ogp></p>\n\n<h2>\n<span id=\"ライブラリのバージョン\" class=\"fragment\"></span><a href=\"#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3\"><i class=\"fa fa-link\"></i></a>ライブラリのバージョン</h2>\n\n<div class=\"code-frame\" data-lang=\"json\"><div class=\"highlight\"><pre><code><span class=\"nl\">\"react\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"17.0.2\"</span><span class=\"w\">\n</span><span class=\"nl\">\"react-native\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"0.65.1\"</span><span class=\"w\">\n</span><span class=\"nl\">\"react-native-unimodules\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"0.14.6\"</span><span class=\"w\">\n</span><span class=\"nl\">\"expo-notifications\"</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">\"0.12.3\"</span><span class=\"w\">\n</span></code></pre></div></div>\n\n<h1>\n<span id=\"手順\" class=\"fragment\"></span><a href=\"#%E6%89%8B%E9%A0%86\"><i class=\"fa fa-link\"></i></a>手順</h1>\n\n<h2>\n<span id=\"既存プロジェクトにreact-native-unimodulesを追加する\" class=\"fragment\"></span><a href=\"#%E6%97%A2%E5%AD%98%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%ABreact-native-unimodules%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>既存プロジェクトにreact-native-unimodulesを追加する</h2>\n\n<p><code>react-native-unimodules</code>はExpoのユニモジュールを使用するためのライブラリです。<br>\n既存のReact Nativeに導入することで、Expoから提供されているAPIを使用できます。</p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>yarn add react-native-unimodules\n<span class=\"nb\">cd</span> ./ios <span class=\"o\">&amp;&amp;</span> pod <span class=\"nb\">install</span>\n</code></pre></div></div>\n\n<p>iOSとAndroidの各設定は公式のドキュメントにあります。<br>\n<a href=\"https://docs.expo.dev/bare/installing-unimodules/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://docs.expo.dev/bare/installing-unimodules/</a></p>\n\n<p>動作確認は、下記で行なえます。<br>\nsystemFontsが<code>undefined</code>でなく、配列が表示されれば正常に設定完了です。</p>\n\n<div class=\"code-frame\" data-lang=\"typescript\"><div class=\"highlight\"><pre><code><span class=\"k\">import</span> <span class=\"p\">{</span><span class=\"nx\">Constants</span><span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">react-native-unimodules</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"nx\">Constants</span><span class=\"p\">.</span><span class=\"nx\">systemFonts</span><span class=\"p\">);</span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"expo-notificationsを追加する\" class=\"fragment\"></span><a href=\"#expo-notifications%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B\"><i class=\"fa fa-link\"></i></a>expo-notificationsを追加する</h2>\n\n<p>Expoの通知のライブラリです。<br>\nローカル通知やExpoの提供するプッシュ通知機能を使用することができます。<br>\nプッシュ通知のテストには、ウェブツールも提供されています。<br>\n<a href=\"https://expo.dev/notifications\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://expo.dev/notifications</a></p>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>yarn add expo-notifications\n</code></pre></div></div>\n\n<p>あとは、他の通知ライブラリと同様、各種APIを使用して通知設定を行うだけです。</p>\n\n<h2>\n<span id=\"20210905-補足-patchの追加\" class=\"fragment\"></span><a href=\"#20210905-%E8%A3%9C%E8%B6%B3-patch%E3%81%AE%E8%BF%BD%E5%8A%A0\"><i class=\"fa fa-link\"></i></a>2021/09/05 補足: patchの追加</h2>\n\n<p><code>react-native-unimodules@0.14.6</code>が、まだ<code>react-native@0.65.1</code>に対応していないため、patchをあてる必要があります。</p>\n\n<p><code>@unimodules+core+7.1.1.patch</code></p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre><code><span class=\"gh\">diff --git a/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m b/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\nindex e1c02e3..c8b7604 100644\n</span><span class=\"gd\">--- a/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\n</span><span class=\"gi\">+++ b/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\n</span><span class=\"p\">@@ -28,7 +28,9 @@</span> UM_REGISTER_MODULE();\n\n - (void)setModuleRegistry:(UMModuleRegistry *)moduleRegistry\n {\n<span class=\"gd\">-  _moduleRegistry = moduleRegistry;\n</span><span class=\"gi\">+  if ([moduleRegistry isKindOfClass: [UMModuleRegistry class]]) {\n+    _moduleRegistry = moduleRegistry;\n+  }\n</span> }\n\n - (nullable NSDictionary *)launchOptions\n\n</code></pre></div></div>\n\n<p><code>@unimodules+react-native-adapter+6.3.5.patch</code></p>\n\n<div class=\"code-frame\" data-lang=\"diff\"><div class=\"highlight\"><pre><code><span class=\"gh\">diff --git a/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m b/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\nindex 7fe313b..6fe899a 100644\n</span><span class=\"gd\">--- a/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\n</span><span class=\"gi\">+++ b/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\n</span><span class=\"p\">@@ -139,7 +139,9 @@</span> RCT_EXPORT_METHOD(removeProxiedListeners:(NSString *)moduleName count:(double)co\n\n - (void)setModuleRegistry:(UMModuleRegistry *)moduleRegistry\n {\n<span class=\"gd\">-  _umModuleRegistry = moduleRegistry;\n</span><span class=\"gi\">+  if ([moduleRegistry isKindOfClass:[UMModuleRegistry class]]) {\n+    _umModuleRegistry = moduleRegistry;\n+  }\n</span> }\n\n @end\n<span class=\"gh\">diff --git a/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js b/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\nindex fdcfaba..d2a55e1 100644\n</span><span class=\"gd\">--- a/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\n</span><span class=\"gi\">+++ b/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\n</span><span class=\"p\">@@ -20,8 +20,10 @@</span> if (NativeProxy) {\n         //\n         // On Android only {start,stop}Observing are called on the native module\n         // and these should be exported as Expo methods.\n<span class=\"gd\">-        NativeModulesProxy[moduleName].addListener = (...args) =&gt; NativeModules.UMReactNativeEventEmitter.addProxiedListener(moduleName, ...args);\n-        NativeModulesProxy[moduleName].removeListeners = (...args) =&gt; NativeModules.UMReactNativeEventEmitter.removeProxiedListeners(moduleName, ...args);\n</span><span class=\"gi\">+        if (NativeModules.UMReactNativeEventEmitter) {\n+            NativeModulesProxy[moduleName].addListener = (...args) =&gt; NativeModules.UMReactNativeEventEmitter.addProxiedListener(moduleName, ...args);\n+            NativeModulesProxy[moduleName].removeListeners = (...args) =&gt; NativeModules.UMReactNativeEventEmitter.removeProxiedListeners(moduleName, ...args);\n+        }\n</span>     });\n }\n else {\n</code></pre></div></div>\n\n<h1>\n<span id=\"おわりに\" class=\"fragment\"></span><a href=\"#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>おわりに</h1>\n\n<p>ライブラリのメンテは、リソースやコストの問題で行われなくなったものをよく見かけます。<br>\nExpoのライブラリはExpoチームによるメンテナンスが行われている安定性をふまえると、<br>\n実際に使用してみなければハマりどころは分からないものですが、<br>\n事業プロダクトでもユニモジュールとして採用候補に入るかと思いました。</p>\n",
    "body": "# はじめに\nExpoは、React Nativeでのアプリ開発を超絶楽に行えるフレームワークです。\nExpoのフルマネージド環境下では、優れた開発体験と引き換えに、ネイティブの機能はExpoで提供されているもの以外を使用できません。\nExpoのAPI郡を使用しながらネイティブの機能を使用するライブラリを使用したい場合、\nExpoプロジェクトの初期化時にBare Workflowを選択したり、\nExpoフルマネージドプロジェクトをejectする等の方法があります。\n今回は既存のReact Nativeプロジェクトでexpo-notificationsを使用する手順を紹介します。\n\nhttps://expo.dev/\n\n# リポジトリ\n\nコードはこちら\n\nhttps://github.com/alternacrow/ExistingReactNativeWithExpoNotifications\n\n## ライブラリのバージョン\n```json\n\"react\": \"17.0.2\"\n\"react-native\": \"0.65.1\"\n\"react-native-unimodules\": \"0.14.6\"\n\"expo-notifications\": \"0.12.3\"\n```\n\n# 手順\n\n## 既存プロジェクトにreact-native-unimodulesを追加する\n\n`react-native-unimodules`はExpoのユニモジュールを使用するためのライブラリです。\n既存のReact Nativeに導入することで、Expoから提供されているAPIを使用できます。\n\n```bash\nyarn add react-native-unimodules\ncd ./ios && pod install\n```\n\niOSとAndroidの各設定は公式のドキュメントにあります。\nhttps://docs.expo.dev/bare/installing-unimodules/\n\n動作確認は、下記で行なえます。\nsystemFontsが`undefined`でなく、配列が表示されれば正常に設定完了です。\n\n```typescript\nimport {Constants} from 'react-native-unimodules';\nconsole.log(Constants.systemFonts);\n```\n\n## expo-notificationsを追加する\n\nExpoの通知のライブラリです。\nローカル通知やExpoの提供するプッシュ通知機能を使用することができます。\nプッシュ通知のテストには、ウェブツールも提供されています。\nhttps://expo.dev/notifications\n\n```bash\nyarn add expo-notifications\n```\n\nあとは、他の通知ライブラリと同様、各種APIを使用して通知設定を行うだけです。\n\n## 2021/09/05 補足: patchの追加\n\n`react-native-unimodules@0.14.6`が、まだ`react-native@0.65.1`に対応していないため、patchをあてる必要があります。\n\n`@unimodules+core+7.1.1.patch`\n\n```diff\ndiff --git a/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m b/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\nindex e1c02e3..c8b7604 100644\n--- a/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\n+++ b/node_modules/@unimodules/core/ios/UMCore/UMUtilities.m\n@@ -28,7 +28,9 @@ UM_REGISTER_MODULE();\n\n - (void)setModuleRegistry:(UMModuleRegistry *)moduleRegistry\n {\n-  _moduleRegistry = moduleRegistry;\n+  if ([moduleRegistry isKindOfClass: [UMModuleRegistry class]]) {\n+    _moduleRegistry = moduleRegistry;\n+  }\n }\n\n - (nullable NSDictionary *)launchOptions\n\n```\n\n`@unimodules+react-native-adapter+6.3.5.patch`\n\n```diff\ndiff --git a/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m b/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\nindex 7fe313b..6fe899a 100644\n--- a/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\n+++ b/node_modules/@unimodules/react-native-adapter/ios/UMReactNativeAdapter/Services/UMReactNativeEventEmitter.m\n@@ -139,7 +139,9 @@ RCT_EXPORT_METHOD(removeProxiedListeners:(NSString *)moduleName count:(double)co\n\n - (void)setModuleRegistry:(UMModuleRegistry *)moduleRegistry\n {\n-  _umModuleRegistry = moduleRegistry;\n+  if ([moduleRegistry isKindOfClass:[UMModuleRegistry class]]) {\n+    _umModuleRegistry = moduleRegistry;\n+  }\n }\n\n @end\ndiff --git a/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js b/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\nindex fdcfaba..d2a55e1 100644\n--- a/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\n+++ b/node_modules/@unimodules/react-native-adapter/build/NativeModulesProxy.native.js\n@@ -20,8 +20,10 @@ if (NativeProxy) {\n         //\n         // On Android only {start,stop}Observing are called on the native module\n         // and these should be exported as Expo methods.\n-        NativeModulesProxy[moduleName].addListener = (...args) => NativeModules.UMReactNativeEventEmitter.addProxiedListener(moduleName, ...args);\n-        NativeModulesProxy[moduleName].removeListeners = (...args) => NativeModules.UMReactNativeEventEmitter.removeProxiedListeners(moduleName, ...args);\n+        if (NativeModules.UMReactNativeEventEmitter) {\n+            NativeModulesProxy[moduleName].addListener = (...args) => NativeModules.UMReactNativeEventEmitter.addProxiedListener(moduleName, ...args);\n+            NativeModulesProxy[moduleName].removeListeners = (...args) => NativeModules.UMReactNativeEventEmitter.removeProxiedListeners(moduleName, ...args);\n+        }\n     });\n }\n else {\n```\n\n# おわりに\n\nライブラリのメンテは、リソースやコストの問題で行われなくなったものをよく見かけます。\nExpoのライブラリはExpoチームによるメンテナンスが行われている安定性をふまえると、\n実際に使用してみなければハマりどころは分からないものですが、\n事業プロダクトでもユニモジュールとして採用候補に入るかと思いました。\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-09-05T18:32:48+09:00",
    "group": null,
    "id": "14f2d5e873b64807c59e",
    "likes_count": 0,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "react-native",
        "versions": []
      },
      {
        "name": "expo-notifications",
        "versions": []
      },
      {
        "name": "react-native-unimodules",
        "versions": []
      }
    ],
    "title": "既存のreact-nativeプロジェクトでexpo-notificationsを使う",
    "updated_at": "2021-09-05T18:32:48+09:00",
    "url": "https://qiita.com/alternacrow/items/14f2d5e873b64807c59e",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  },
  {
    "rendered_body": "\n<h1>\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h1>\n\n<p>タイトルままです。<br>\nReactNativeで通知からアプリを開いたときに、<br>\n通知の種類に合わせて任意の画面を表示する方法について紹介します。</p>\n\n<h1>\n<span id=\"説明しないこと\" class=\"fragment\"></span><a href=\"#%E8%AA%AC%E6%98%8E%E3%81%97%E3%81%AA%E3%81%84%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>説明しないこと</h1>\n\n<ul>\n<li>react-navigationの基本的な使い方</li>\n<li>react-native-push-notificationの基本的な使い方</li>\n</ul>\n\n<h1>\n<span id=\"使用ライブラリ\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E7%94%A8%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA\"><i class=\"fa fa-link\"></i></a>使用ライブラリ</h1>\n\n<ul>\n<li>通知用\n\n<ul>\n<li><code>@react-native-community/push-notification-ios:^1.8.0</code></li>\n<li><code>react-native-push-notification:^7.4.0</code></li>\n</ul>\n</li>\n<li>タブ用\n\n<ul>\n<li><code>@react-navigation/native:^5.9.4</code></li>\n<li><code>react-native-reanimated:^2.2.0</code></li>\n<li><code>react-native-gesture-handler:^1.10.3</code></li>\n<li><code>react-native-screens:^3.4.0</code></li>\n<li><code>react-native-safe-area-context:^3.2.0</code></li>\n<li><code>@react-native-community/masked-view:^0.1.11</code></li>\n<li><code>@react-navigation/bottom-tabs:^5.11.11</code></li>\n</ul>\n</li>\n</ul>\n\n<h1>\n<span id=\"コード\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>コード</h1>\n\n<div class=\"code-frame\" data-lang=\"react\"><div class=\"highlight\"><pre><code><span class=\"k\">import</span> <span class=\"nx\">React</span><span class=\"p\">,</span> <span class=\"p\">{</span><span class=\"nx\">createRef</span><span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">react</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"p\">{</span><span class=\"nx\">NavigationContainer</span><span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">@react-navigation/native</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n<span class=\"k\">import</span> <span class=\"nx\">PushNotification</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">react-native-push-notification</span><span class=\"dl\">'</span><span class=\"p\">;</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">navigation</span> <span class=\"o\">=</span> <span class=\"nx\">createRef</span><span class=\"p\">().</span><span class=\"nx\">current</span><span class=\"p\">;</span>\n\n<span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">configure</span><span class=\"p\">({</span>\n  <span class=\"na\">onNotification</span><span class=\"p\">:</span> <span class=\"nx\">notification</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"nx\">navigation</span><span class=\"p\">.</span><span class=\"nx\">navigate</span><span class=\"p\">(</span><span class=\"nx\">notification</span><span class=\"p\">.</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">screen</span><span class=\"p\">);</span>\n  <span class=\"p\">},</span>\n<span class=\"p\">});</span>\n\n<span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">popInitialNotification</span><span class=\"p\">(</span><span class=\"nx\">initialNotification</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">initialNotification</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">navigation</span><span class=\"p\">.</span><span class=\"nx\">navigate</span><span class=\"p\">(</span><span class=\"nx\">initialNotification</span><span class=\"p\">.</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">screen</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">});</span>\n\n<span class=\"kd\">const</span> <span class=\"nx\">scheduleNotification</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"nx\">screenName</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">localNotificationSchedule</span><span class=\"p\">({</span>\n    <span class=\"na\">id</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n    <span class=\"na\">title</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">title</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">message</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">message</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">date</span><span class=\"p\">:</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">setMinutes</span><span class=\"p\">(</span><span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">getMinutes</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)),</span> <span class=\"c1\">// 1分後</span>\n    <span class=\"na\">userInfo</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"na\">screen</span><span class=\"p\">:</span> <span class=\"nx\">screenName</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">channelId</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">CHANNEL_ID</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n  <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n\n<span class=\"p\">...</span>\n\n<span class=\"o\">&lt;</span><span class=\"nx\">NavigationContainer</span> <span class=\"nx\">ref</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"nx\">navigationRef</span><span class=\"p\">}</span><span class=\"o\">&gt;</span>\n  <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Navigator</span> <span class=\"na\">initialRouteName</span><span class=\"p\">=</span><span class=\"s\">\"Home\"</span><span class=\"p\">&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Home\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">HomeScreen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Tab1\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">Tab1Screen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Tab2\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">Tab2Screen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Tab3\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">Tab3Screen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Tab4\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">Tab4Screen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n  <span class=\"p\">&lt;/</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Navigator</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;</span><span class=\"err\">/</span><span class=\"na\">NavigationContainer</span><span class=\"p\">&gt;</span>\n</code></pre></div></div>\n\n<h1>\n<span id=\"解説\" class=\"fragment\"></span><a href=\"#%E8%A7%A3%E8%AA%AC\"><i class=\"fa fa-link\"></i></a>解説</h1>\n\n<div class=\"code-frame\" data-lang=\"react\"><div class=\"highlight\"><pre><code><span class=\"kd\">const</span> <span class=\"nx\">navigationRef</span> <span class=\"o\">=</span> <span class=\"nx\">createRef</span><span class=\"p\">();</span>\n\n<span class=\"p\">...</span>\n\n<span class=\"o\">&lt;</span><span class=\"nx\">NavigationContainer</span> <span class=\"nx\">ref</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"nx\">navigationRef</span><span class=\"p\">}</span><span class=\"o\">&gt;</span>\n  <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Navigator</span> <span class=\"na\">initialRouteName</span><span class=\"p\">=</span><span class=\"s\">\"Home\"</span><span class=\"p\">&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Home\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">HomeScreen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    <span class=\"p\">&lt;</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Screen</span> <span class=\"na\">name</span><span class=\"p\">=</span><span class=\"s\">\"Tab1\"</span> <span class=\"na\">component</span><span class=\"p\">=</span><span class=\"si\">{</span><span class=\"nx\">Tab1Screen</span><span class=\"si\">}</span> <span class=\"p\">/&gt;</span>\n    ...\n  <span class=\"p\">&lt;/</span><span class=\"nc\">Tab</span><span class=\"p\">.</span><span class=\"nc\">Navigator</span><span class=\"p\">&gt;</span>\n<span class=\"p\">&lt;</span><span class=\"err\">/</span><span class=\"na\">NavigationContainer</span><span class=\"p\">&gt;</span>\n</code></pre></div></div>\n\n<p>通知からアプリを開いたときの処理は、<br>\n後述の<code>PushNotification.configure</code>で設定するのですが、<br>\n<a href=\"https://github.com/zo0r/react-native-push-notification\" rel=\"nofollow noopener\" target=\"_blank\">react-native-push-notification</a>のドキュメントでは、<br>\n<code>Must be outside of any component LifeCycle (such as `componentDidMount`).</code>とあり、<br>\nReactのライフサイクルの影響で重複して設定されることがないよう、<br>\nReactコンポーネント外で実行する必要があります。</p>\n\n<p>そのため、必然的に<code>react-navigation</code>の画面遷移はコンポーネント外で行うことになり、<br>\nスクリーンに渡ってくる<code>props</code>や<code>useNavigation</code>を使えません。</p>\n\n<p>そこで、<code>NavigationContainer</code>にRefを渡して、navigationにアクセスする方法を取ります。</p>\n\n<div class=\"code-frame\" data-lang=\"react\"><div class=\"highlight\"><pre><code><span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">configure</span><span class=\"p\">({</span>\n  <span class=\"na\">onNotification</span><span class=\"p\">:</span> <span class=\"nx\">notification</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"nx\">navigation</span><span class=\"p\">.</span><span class=\"nx\">navigate</span><span class=\"p\">(</span><span class=\"nx\">notification</span><span class=\"p\">.</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">screen</span><span class=\"p\">);</span>\n  <span class=\"p\">},</span>\n<span class=\"p\">});</span>\n</code></pre></div></div>\n\n<p><code>PushNotification.configure</code>の<code>onNotification</code>では、<br>\nアプリを開いている状態、もしくはアプリがバックグラウンドで起動している状態で<br>\n通知をタップした場合の設定を行うことができます。</p>\n\n<p>コールバック引数の<code>notification</code>の<code>data</code>には、<br>\n通知設定の<code>userInfo</code>パラメータに設定したデータが渡ってきます。<br>\n遷移先がReactの<code>state</code>に依存するような場合には、<br>\n通知設定時に遷移先を設定することで、通知の種類に応じた画面を表示することができます。</p>\n\n<div class=\"code-frame\" data-lang=\"javascript\"><div class=\"highlight\"><pre><code><span class=\"kd\">const</span> <span class=\"nx\">scheduleNotification</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"nx\">screenName</span><span class=\"p\">)</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">localNotificationSchedule</span><span class=\"p\">({</span>\n    <span class=\"na\">id</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n    <span class=\"na\">title</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">title</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">message</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">message</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"na\">date</span><span class=\"p\">:</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">setMinutes</span><span class=\"p\">(</span><span class=\"nx\">now</span><span class=\"p\">.</span><span class=\"nx\">getMinutes</span><span class=\"p\">()</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)),</span> <span class=\"c1\">// 1分後</span>\n    <span class=\"na\">userInfo</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"na\">screen</span><span class=\"p\">:</span> <span class=\"nx\">screenName</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n    <span class=\"na\">channelId</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">CHANNEL_ID</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n  <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>アプリが起動している状態（バックグラウンド含む）では、<br>\n<code>PushNotification.configure</code>で通知をタップしたときの挙動を設定できますが、<br>\nアプリが起動していない状態では、<br>\n<code>PushNotification.popInitialNotification</code>を使用することで、<br>\n通知からアプリを開いたときの挙動を設定できます。</p>\n\n<div class=\"code-frame\" data-lang=\"javascript\"><div class=\"highlight\"><pre><code><span class=\"nx\">PushNotification</span><span class=\"p\">.</span><span class=\"nx\">popInitialNotification</span><span class=\"p\">(</span><span class=\"nx\">initialNotification</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">initialNotification</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">navigation</span><span class=\"p\">.</span><span class=\"nx\">navigate</span><span class=\"p\">(</span><span class=\"nx\">initialNotification</span><span class=\"p\">.</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">screen</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">});</span>\n</code></pre></div></div>\n\n<p><code>initialNotification</code>には<code>PushNotification.configure</code>の<code>onNotification</code>と同じく、<br>\n<code>userInfo</code>で渡したパラメータが<code>data</code>に渡ってきます。</p>\n\n<h3>\n<span id=\"参考\" class=\"fragment\"></span><a href=\"#%E5%8F%82%E8%80%83\"><i class=\"fa fa-link\"></i></a>参考</h3>\n\n<p><qiita-embed-ogp src=\"https://github.com/zo0r/react-native-push-notification\"></qiita-embed-ogp></p>\n\n<p><qiita-embed-ogp src=\"https://reactnavigation.org/\"></qiita-embed-ogp></p>\n",
    "body": "# はじめに\n\nタイトルままです。\nReactNativeで通知からアプリを開いたときに、\n通知の種類に合わせて任意の画面を表示する方法について紹介します。\n\n# 説明しないこと\n\n- react-navigationの基本的な使い方\n- react-native-push-notificationの基本的な使い方\n\n# 使用ライブラリ\n\n- 通知用\n    - `@react-native-community/push-notification-ios:^1.8.0`\n    - `react-native-push-notification:^7.4.0`\n- タブ用\n    - `@react-navigation/native:^5.9.4`\n    - `react-native-reanimated:^2.2.0`\n    - `react-native-gesture-handler:^1.10.3`\n    - `react-native-screens:^3.4.0`\n    - `react-native-safe-area-context:^3.2.0`\n    - `@react-native-community/masked-view:^0.1.11`\n    - `@react-navigation/bottom-tabs:^5.11.11`\n\n# コード\n\n\n\n```react\nimport React, {createRef} from 'react';\nimport {NavigationContainer} from '@react-navigation/native';\nimport PushNotification from 'react-native-push-notification';\n\nconst navigation = createRef().current;\n\nPushNotification.configure({\n  onNotification: notification => {\n    navigation.navigate(notification.data.screen);\n  },\n});\n\nPushNotification.popInitialNotification(initialNotification => {\n  if (initialNotification) {\n    navigation.navigate(initialNotification.data.screen);\n  }\n});\n\nconst scheduleNotification = (screenName) => {\n  PushNotification.localNotificationSchedule({\n    id: 1,\n    title: 'title',\n    message: 'message',\n    date: new Date(now.setMinutes(now.getMinutes() + 1)), // 1分後\n    userInfo: {\n      screen: screenName,\n    },\n    channelId: 'CHANNEL_ID',\n  });\n}\n\n...\n\n<NavigationContainer ref={navigationRef}>\n  <Tab.Navigator initialRouteName=\"Home\">\n    <Tab.Screen name=\"Home\" component={HomeScreen} />\n    <Tab.Screen name=\"Tab1\" component={Tab1Screen} />\n    <Tab.Screen name=\"Tab2\" component={Tab2Screen} />\n    <Tab.Screen name=\"Tab3\" component={Tab3Screen} />\n    <Tab.Screen name=\"Tab4\" component={Tab4Screen} />\n  </Tab.Navigator>\n</NavigationContainer>\n```\n\n# 解説\n\n```react\nconst navigationRef = createRef();\n\n...\n\n<NavigationContainer ref={navigationRef}>\n  <Tab.Navigator initialRouteName=\"Home\">\n    <Tab.Screen name=\"Home\" component={HomeScreen} />\n    <Tab.Screen name=\"Tab1\" component={Tab1Screen} />\n    ...\n  </Tab.Navigator>\n</NavigationContainer>\n```\n\n通知からアプリを開いたときの処理は、\n後述の`PushNotification.configure`で設定するのですが、\n[react-native-push-notification](https://github.com/zo0r/react-native-push-notification)のドキュメントでは、\n```Must be outside of any component LifeCycle (such as `componentDidMount`).```とあり、\nReactのライフサイクルの影響で重複して設定されることがないよう、\nReactコンポーネント外で実行する必要があります。\n\nそのため、必然的に`react-navigation`の画面遷移はコンポーネント外で行うことになり、\nスクリーンに渡ってくる`props`や`useNavigation`を使えません。\n\nそこで、`NavigationContainer`にRefを渡して、navigationにアクセスする方法を取ります。\n\n```react\nPushNotification.configure({\n  onNotification: notification => {\n    navigation.navigate(notification.data.screen);\n  },\n});\n```\n\n`PushNotification.configure`の`onNotification`では、\nアプリを開いている状態、もしくはアプリがバックグラウンドで起動している状態で\n通知をタップした場合の設定を行うことができます。\n\nコールバック引数の`notification`の`data`には、\n通知設定の`userInfo`パラメータに設定したデータが渡ってきます。\n遷移先がReactの`state`に依存するような場合には、\n通知設定時に遷移先を設定することで、通知の種類に応じた画面を表示することができます。\n\n\n```javascript\nconst scheduleNotification = (screenName) => {\n  PushNotification.localNotificationSchedule({\n    id: 1,\n    title: 'title',\n    message: 'message',\n    date: new Date(now.setMinutes(now.getMinutes() + 1)), // 1分後\n    userInfo: {\n      screen: screenName,\n    },\n    channelId: 'CHANNEL_ID',\n  });\n}\n```\n\nアプリが起動している状態（バックグラウンド含む）では、\n`PushNotification.configure`で通知をタップしたときの挙動を設定できますが、\nアプリが起動していない状態では、\n`PushNotification.popInitialNotification`を使用することで、\n通知からアプリを開いたときの挙動を設定できます。\n\n\n```javascript\nPushNotification.popInitialNotification(initialNotification => {\n  if (initialNotification) {\n    navigation.navigate(initialNotification.data.screen);\n  }\n});\n```\n\n`initialNotification`には`PushNotification.configure`の`onNotification`と同じく、\n`userInfo`で渡したパラメータが`data`に渡ってきます。\n\n\n\n### 参考\n\nhttps://github.com/zo0r/react-native-push-notification\n\nhttps://reactnavigation.org/\n\n\n\n",
    "coediting": false,
    "comments_count": 0,
    "created_at": "2021-08-09T20:45:24+09:00",
    "group": null,
    "id": "3d2877c2de6ee467eacf",
    "likes_count": 3,
    "private": false,
    "reactions_count": 0,
    "tags": [
      {
        "name": "Push通知",
        "versions": []
      },
      {
        "name": "react-native",
        "versions": []
      },
      {
        "name": "react-navigation",
        "versions": []
      }
    ],
    "title": "通知からアプリを開いたときに任意の画面へ遷移する  ",
    "updated_at": "2021-08-09T20:45:24+09:00",
    "url": "https://qiita.com/alternacrow/items/3d2877c2de6ee467eacf",
    "user": {
      "description": "TypeScript / React Native 好きです。",
      "facebook_id": "",
      "followees_count": 2,
      "followers_count": 0,
      "github_login_name": "alternacrow",
      "id": "alternacrow",
      "items_count": 10,
      "linkedin_id": "",
      "location": "",
      "name": "",
      "organization": "",
      "permanent_id": 684679,
      "profile_image_url": "https://avatars3.githubusercontent.com/u/35155361?v=4",
      "team_only": false,
      "twitter_screen_name": null,
      "website_url": ""
    },
    "page_views_count": null,
    "team_membership": null
  }
]
